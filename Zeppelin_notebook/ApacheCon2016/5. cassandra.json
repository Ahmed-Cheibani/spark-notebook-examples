{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462939449161_-1733200476","id":"20160511-040409_1990837329","dateCreated":"May 11, 2016 4:04:09 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:943","text":"%cassandra\nHELP;\n","dateUpdated":"May 11, 2016 4:49:10 AM","dateFinished":"May 11, 2016 4:48:59 AM","dateStarted":"May 11, 2016 4:48:38 AM","errorMessage":"","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462939458586_328299455","id":"20160511-040418_1008951802","dateCreated":"May 11, 2016 4:04:18 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1008","dateUpdated":"May 11, 2016 4:50:23 AM","dateFinished":"May 11, 2016 4:50:25 AM","dateStarted":"May 11, 2016 4:50:23 AM","errorMessage":"","text":"%cassandra\n\nCREATE KEYSPACE IF NOT EXISTS test WITH REPLICATION = { \n\t'class' : 'org.apache.cassandra.locator.SimpleStrategy', \n\t'replication_factor': '1' }\nAND DURABLE_WRITES = true;\n\nCREATE TABLE IF NOT EXISTS test.test_max (\n    id int,\n    val1 int,\n    val2 int,\n    PRIMARY KEY (id)\n);\n\nCREATE FUNCTION IF NOT EXISTS test.maxOf(\n    val1 int,\n    val2 int)\nRETURNS NULL ON NULL INPUT\nRETURNS int\nLANGUAGE java\nAS $$\n  return Math.max(val1, val2);\n$$;\n\nTRUNCATE test.test_max;\nINSERT INTO test.test_max(id,val1,val2) VALUES(1,100,110);\nINSERT INTO test.test_max(id,val1,val2) VALUES(2,200,110);\nINSERT INTO test.test_max(id,val1) VALUES(3,100);\n\nCREATE TABLE IF NOT EXISTS test.items (\n    shop_id text,\n    day int,\n    category text,\n    sales_count int,\n    PRIMARY KEY (shop_id, day, category)\n);\n\nCREATE FUNCTION IF NOT EXISTS test.accumulator(\n    state map<text, int>,\n    category text,\n    count int)\nRETURNS NULL ON NULL INPUT\nRETURNS map<text, int>\nLANGUAGE java\nAS $$ \n if(state.containsKey(category)) {\n    state.put(category, (Integer)state.get(category) + count); \n } else { \n    state.put(category, count); \n } \n return state; \n$$;\n\nCREATE AGGREGATE IF NOT EXISTS test.group_by(text,int)\nSFUNC accumulator \nSTYPE map<text, int>\nINITCOND {};\n\nTRUNCATE test.items;\nINSERT INTO test.items(shop_id,day,category,sales_count) VALUES('AMAZON',20151201,'BOOKS',345);\nINSERT INTO test.items(shop_id,day,category,sales_count) VALUES('AMAZON',20151201,'DVD',5000);\nINSERT INTO test.items(shop_id,day,category,sales_count) VALUES('AMAZON',20151201,'GAMES',734);\nINSERT INTO test.items(shop_id,day,category,sales_count) VALUES('AMAZON',20151202,'BOOKS',120);\nINSERT INTO test.items(shop_id,day,category,sales_count) VALUES('AMAZON',20151202,'DVD',7483);\nINSERT INTO test.items(shop_id,day,category,sales_count) VALUES('AMAZON',20151202,'GAMES',1340);\n\nCREATE TABLE IF NOT EXISTS test.user (\n    id int,\n    country text,\n    firstname text,\n    lastname text,\n    login text,\n    PRIMARY KEY (id)\n);\n\nCREATE MATERIALIZED VIEW IF NOT EXISTS test.user_by_country AS \nSELECT * FROM test.user \nWHERE id IS NOT NULL AND country IS NOT NULL \nPRIMARY KEY (country, id);\n\n\nTRUNCATE test.user;\nINSERT INTO test.user(id,login,firstname,lastname,country) VALUES(1, 'jdoe', 'John', 'DOE', 'US');\nINSERT INTO test.user(id,login,firstname,lastname,country) VALUES(2, 'hsue', 'Helen', 'SUE', 'US');\nINSERT INTO test.user(id,login,firstname,lastname,country) VALUES(3, 'rsmith', 'Richard', 'SMITH', 'UK');\nINSERT INTO test.user(id,login,firstname,lastname,country) VALUES(4, 'doanduyhai', 'DuyHai', 'DOAN', 'FR');"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941404160_-1354307424","id":"20160511-043644_22457440","dateCreated":"May 11, 2016 4:36:44 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1105","dateUpdated":"May 11, 2016 4:50:35 AM","dateFinished":"May 11, 2016 4:50:39 AM","dateStarted":"May 11, 2016 4:50:35 AM","errorMessage":"","text":"%cassandra\n\nDESCRIBE FUNCTION test.maxOf;"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941426849_1323590893","id":"20160511-043706_233731760","dateCreated":"May 11, 2016 4:37:06 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1174","dateUpdated":"May 11, 2016 4:37:47 AM","dateFinished":"May 11, 2016 4:37:47 AM","dateStarted":"May 11, 2016 4:37:47 AM","errorMessage":"","text":"%cassandra\n\nDESCRIBE AGGREGATE test.group_by;"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941463035_-1756092545","id":"20160511-043743_1571102253","dateCreated":"May 11, 2016 4:37:43 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1244","dateUpdated":"May 11, 2016 4:38:11 AM","dateFinished":"May 11, 2016 4:38:14 AM","dateStarted":"May 11, 2016 4:38:11 AM","errorMessage":"","text":"%cassandra\n\nDESCRIBE MATERIALIZED VIEW test.user_by_country;"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941491709_1238084692","id":"20160511-043811_777603615","dateCreated":"May 11, 2016 4:38:11 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1316","dateUpdated":"May 11, 2016 4:50:45 AM","dateFinished":"May 11, 2016 4:50:45 AM","dateStarted":"May 11, 2016 4:50:45 AM","errorMessage":"","text":"%cassandra\n\nSELECT id,val1,val2,maxOf(val1,val2) FROM test.test_max;"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941511877_715995759","id":"20160511-043831_1079962917","dateCreated":"May 11, 2016 4:38:31 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1386","dateUpdated":"May 11, 2016 4:38:52 AM","dateFinished":"May 11, 2016 4:38:52 AM","dateStarted":"May 11, 2016 4:38:52 AM","errorMessage":"","text":"%cassandra\n\nSELECT group_by(category,sales_count) FROM test.items;"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941532223_1570720636","id":"20160511-043852_1478038579","dateCreated":"May 11, 2016 4:38:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1457","dateUpdated":"May 11, 2016 4:39:07 AM","dateFinished":"May 11, 2016 4:39:07 AM","dateStarted":"May 11, 2016 4:39:07 AM","errorMessage":"","text":"%cassandra\n\nSELECT * FROM test.user_by_country WHERE country='FR';"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941547582_389156764","id":"20160511-043907_587847072","dateCreated":"May 11, 2016 4:39:07 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1528","dateUpdated":"May 11, 2016 5:43:47 AM","dateFinished":"May 11, 2016 5:43:47 AM","dateStarted":"May 11, 2016 5:43:47 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Integrating with Spark</h2>\n<h3>First, add Spark package <code>com.datastax.spark:spark-cassandra-connector_2.10:1.6.0-M2</code></h3>\n<h3>And then set <code>spark.cassandra.connection.host</code> to <code>127.0.0.1</code> in the Interpreter menu.</h3>\n<p>https://github.com/datastax/spark-cassandra-connector#version-compatibility</p>\n"},"text":"%md\n\n## Integrating with Spark\n### First, add Spark package `com.datastax.spark:spark-cassandra-connector_2.10:1.6.0-M2`\n### And then set `spark.cassandra.connection.host` to `127.0.0.1` in the Interpreter menu.\n\nhttps://github.com/datastax/spark-cassandra-connector#version-compatibility\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941662416_1328899112","id":"20160511-044102_1937237869","dateCreated":"May 11, 2016 4:41:02 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1602","dateUpdated":"May 11, 2016 5:26:55 AM","dateFinished":"May 11, 2016 5:24:42 AM","dateStarted":"May 11, 2016 5:24:03 AM","errorMessage":"","text":"val cassandraConfig = Map(\"keyspace\" -> \"test\", \"table\" -> \"user\")\nval usersDF = sqlContext.read.format(\"org.apache.spark.sql.cassandra\")\n  .options(cassandraConfig)\n  .load()\n\nusersDF\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"id","index":0,"aggr":"sum"}],"values":[{"name":"country","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"id","index":0,"aggr":"sum"},"yAxis":{"name":"country","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462941862015_280721039","id":"20160511-044422_1558410691","dateCreated":"May 11, 2016 4:44:22 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1710","dateUpdated":"May 11, 2016 5:27:08 AM","dateFinished":"May 11, 2016 5:26:49 AM","dateStarted":"May 11, 2016 5:26:46 AM","errorMessage":"","text":"z.show(usersDF)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462944598368_1997409858","id":"20160511-052958_1698518242","dateCreated":"May 11, 2016 5:29:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2185","dateUpdated":"May 11, 2016 5:41:24 AM","dateFinished":"May 11, 2016 5:41:27 AM","dateStarted":"May 11, 2016 5:41:24 AM","errorMessage":"","text":"sqlContext.sql(\n   \"\"\"CREATE TEMPORARY TABLE users\n     |USING org.apache.spark.sql.cassandra\n     |OPTIONS (\n     |  table \"user\",\n     |  keyspace \"test\",\n     |  cluster \"Test Cluster\",\n     |  pushdown \"true\"\n     |)\"\"\".stripMargin)\nval df = sqlContext.sql(\"SELECT * FROM users\")\nz.show(df)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"_c0","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"_c0","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462944627433_-1836982356","id":"20160511-053027_770075169","dateCreated":"May 11, 2016 5:30:27 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2261","dateUpdated":"May 11, 2016 5:42:37 AM","dateFinished":"May 11, 2016 5:42:40 AM","dateStarted":"May 11, 2016 5:42:37 AM","errorMessage":"","text":"%sql\nSELECT country, count(*) AS count FROM users GROUP BY country"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1462945339647_-435904174","id":"20160511-054219_1758640441","dateCreated":"May 11, 2016 5:42:19 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2435","errorMessage":""}],"name":"cassandra","id":"2BHKA99QH","angularObjects":{"2BJYXC3U9:shared_process":[],"2BM3HNZ9A:shared_process":[],"2BK6YYY9F:shared_process":[],"2BM8469CZ:shared_process":[],"2BMJ5HHS1:shared_process":[],"2BJUGUTZ6:shared_process":[],"2BK9JP4UX:shared_process":[],"2BN37E28N:shared_process":[],"2BMSH41WH:shared_process":[],"2BMXC4PKP:shared_process":[],"2BKY2E1KT:shared_process":[],"2BK94F9SU:shared_process":[],"2BJS7ZX34:shared_process":[],"2BJW3KXB4:shared_process":[],"2BM5ENSC4:shared_process":[],"2BM7G9XDR:shared_process":[],"2BKW36KUE:shared_process":[],"2BHV8DWGW:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}